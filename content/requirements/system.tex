\subsection{System Requirements}

\subitem{
    The System provides the hardware and software foundation for all onboard modules. It includes processing, hardware capabilities, interfaces, hardware abstraction, and power management. The System is comprised of five main parts: Processing, Built in HW Capabilities, HW Interfaces, HAL, and Power Management.
}

\subsubsection{Interfaces}
\paragraph{Inputs}
\begin{enumerate}
    \item All submodules require configuration parameters that dictate their operation. These parameters will all be contained in a
            YAML file required for operation start. These configuration parameters will be different dependant on the individual submodule,
            and that submodule will define the contents of its own configuration. In software, the parameters will be passed as a predefined object,
            referred to as a struct, though there is no requirement to utilize the C programming language and it's associated structs.
    \item Waypoints are defined as a time index series of LLA points. Waypoints do not require an orientation or velocity component to avoid
            overconstraining the Planner submodule.
    \item RC inputs are defined as the literal signals received from the RC receiver. This includes the raw stick inputs, as well as any auxiliary channels.
            The layout of these channels will be defined in the configuration parameters for a specific transmitter.
    \item External sensor data is defined as raw data received from any sensors not directly connected to the onboard PCB. This includes sensors
            connected via serial communication.
\end{enumerate}
\paragraph{Outputs}
\begin{enumerate}
    \item Peripheral commands are defined as commands to control onboard motors and servos. These commands are generated by the Controller submodule.
\end{enumerate}
\paragraph{Internal}
\begin{enumerate}
    \item UAV state estimates are defined as the best estimate of the UAV's current position, orientation, velocity, and angular velocity. This estimate is generated by the Navigation submodule.
    \item Desired states are defined as a time index series of the positions, orientations, velocities, and angular velocities. These desired states are generated by the Planner submodule.
    \item State mask is defined as a bitmask indicating which states are to be controlled by the Controller submodule, and is generated by the Planner submodule.
    \item RC adjustments are defined as trims and scaling factors for each control input. Based on the transmitter mapping, the adjusments will be applied to the raw RC inputs and passed to the Logger for logging. These adjustments are generated by the Planner submodule.
    \item Raw control outputs are defined as the initial values calculated by the Controller for percent thrust, aileron deflection, elevator deflection, and rudder deflection. These values aren't directly used, but are passed to the Logger for logging purposes.
    \item Error reports are defined as any fault or error detected by the HAL or Planner, Navigation, or Controller submodules during operation. These reports are passed to the Logger for logging and potential transmission. Error reports shall include a timestamp, error code, and description of the error.
    \item Onboard sensor data is defined as raw data received from any sensors directly connected to the onboard PCB.
\end{enumerate}

\subsubsection{Processing}
\subitem{
    The Processing part provides the computational resources and pipeline for all onboard software modules.
}
\begin{enumerate}
    \item The FCM shall provide a central processor to execute software instructions.
    \item The central processor of the FCM shall support a processing speed such that the hyperperiod of all of the tasks is $2.5$ ms($400$ Hz).
    \item The central processor of the FCM shall employ a real-time operating system to handle task scheduling.
    \item The central processor of the FCM shall support task isolation, such that a crash on one task does not cause failure of another task.
    \item The central processor of the FCM shall monitor the software program state in order to catch illegal operations.
    \item The central processor of the FCM shall provide a failsafe state to provide graceful failure upon catching such faults.
\end{enumerate}

\subsubsection{Built in HW Capabilities}
\subitem{
    Built-in hardware capabilities include sensors, and onboard peripherals required for mission execution.
}
\begin{enumerate}
    \item The FCM shall provide an on-board IMU.
    \item The FCM shall provide an on-board RC receiver for teleoperation.
    \item The FCM shall provide an on-board micro-SD card reader for data storage.
    \item The FCM shall provide on-board power monitoring.
    \item The FCM shall provide on-board power regulation.
\end{enumerate}

\subsubsection{HW Interfaces}
\subitem{
    Hardware interfaces provide connectivity between onboard modules and external devices.
}
\begin{enumerate}
    \item The FCM shall expose pins for the following hardware interfaces: \begin{itemize}
        \item I$^2$C
        \item SPI
        \item UART
        \item USB A
        \item 2 conductor CAN bus
        \item Micro SD
    \end{itemize}
    \item The ports for each of the specified interfaces shall be soldered onto the FCM.
    \item The ports for each of the specified interfaces shall support a locking mechanism to secure interface connections.
\end{enumerate}

\subsubsection{HAL}
\subitem{
    The Hardware Abstraction Layer (HAL) provides a uniform interface to hardware resources, abstracting device specifics from higher-level modules.
    All configuration of the system will be done through the HAL. All necessary configuration information will be included in the YAML file which will be
    read in at program initialization.
}

\paragraph{Requirements}
\begin{enumerate}
    \item The HAL shall provide a scope and deliverables document detailing the capabilities and resources offered.
    \item The HAL scope and deliverables document shall include support to at least the following functionalities:
    \begin{itemize}
        \item GPIO pin control
        \item I2C/SPI bus management
        \item UART serial communication
        \item USB 2.0 serial communication
        \item CAN communication
        \item Micro SD card read and write support
        \item ADC support
        \item Timer control
        \item Interrupt control
        \item Generic device interfacing (Requires associated driver)
    \end{itemize}
    \item The HAL shall provide an ICD outlining the APIs utilized for all functionality described in the scope and deliverables document.
    \item The HAL ICD shall describe the ownership of all memory for all functions receiving or returning memory pointers.
    \item The HAL shall provide common status codes which are returned from all HAL functions to avoid silent failures.
    \item The HAL shall provide a method of gracefully handling faults and reporting those faults.
    \item The HAL shall adhere to all coding standards described in \S X.X.X
    \item The HAL shall use no more than 25\% of the total CPU time allocated to the onboard software system. This will be verified through profiling tools as such as \texttt{perf} or \texttt{htop}.
\end{enumerate}

\subsubsection{Power Management}
\subitem{
    Power Management ensures efficient and reliable power distribution to all system components.
}
\begin{enumerate}
    \item The FCM shall accept power via an external source at a voltage of $5V \pm 0.25V$.
    \item The FCM shall provide a method to protect hardware in case of current higher than $5$ amps.
    \item The FCM shall provide protection in the case of initial voltage lower than $4.75$ such that the device will not initialize.
    \item The FCM shall monitor the power source voltage throughout operation.
    \item The FCM shall signal to the planner in the case of a critically low voltage ($4.25V$). This way the planner can attempt to ground the UAV before catastrophic crash.
\end{enumerate}

\subsubsection{Sub-Parts}
\subitem{
    The System is comprised of four functional sub-parts:
}
\begin{enumerate}
    \item Planner
    \item Controller
    \item Navigation
    \item Logger
\end{enumerate}

% \subsubsection{Functional Requirements}
% \begin{enumerate}
%     \item Provide computational, hardware, and interface resources for all modules.
% \end{enumerate}
% \paragraph{Submodules}
% \begin{enumerate}
%     \item Processing Core
%     \item Processing Architecture
%     \item Hardware Platform
%     \item Configuration Tool
% \end{enumerate}

% \subsubsection{Non-Functional Requirements}
% \textbf{Energy}
% \begin{enumerate}
%     \item Energy Requirement 1
% \end{enumerate}
% \textbf{Environments}
% \begin{enumerate}
%     \item Environment Requirement 1
% \end{enumerate}
% \textbf{Safety}
% \begin{enumerate}
%     \item Safety Requirement 1
% \end{enumerate}
% \textbf{Structure}
% \begin{enumerate}
%     \item Structure Requirement 1
% \end{enumerate}
% \textbf{Standards and Regulations}
% \begin{enumerate}
%     \item Standards and Regulations Requirement 1
% \end{enumerate}

%%% End System Requirements